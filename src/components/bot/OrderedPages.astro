---

---

<script>
	import {
		isTransitionBeforePreparationEvent,
		TRANSITION_BEFORE_PREPARATION,
	} from 'astro:transitions/client';

	document.addEventListener(TRANSITION_BEFORE_PREPARATION, (e) => {
		const pages = [...document.querySelectorAll('.top-level a')].map(
			(a) => new URL((a as HTMLAnchorElement).href).pathname
		);
		if (isTransitionBeforePreparationEvent(e)) {
			const fromIdx = pages.indexOf(e.from.pathname);
			const toIdx = pages.indexOf(e.to.pathname);

			e.direction =
				fromIdx === -1 || toIdx === -1
					? e.direction
					: fromIdx === toIdx
						? 'stay'
						: fromIdx < toIdx
							? 'forward'
							: 'back';
		}
	});
</script>
